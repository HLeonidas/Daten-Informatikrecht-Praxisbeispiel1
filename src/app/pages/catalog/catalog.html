<section class="py-6">
	<header class="mb-8">
		<h1 class="text-3xl font-semibold tracking-tight text-gray-900 sm:text-4xl">
			Katalog
		</h1>
		<p class="mt-3 max-w-prose text-gray-600">
			Entdecke Spiele, die in deinem Abo enthalten sind (Mock-Daten).
		</p>
	</header>

	<!-- Filters -->
	<section class="rounded-2xl border border-gray-200 bg-white p-5 shadow-sm">
		<h2 class="text-base font-semibold text-gray-900">Filter</h2>

		<div class="mt-4 grid gap-4 md:grid-cols-12">
			<!-- Search -->
			<div class="md:col-span-5">
				<label for="search" class="text-sm font-medium text-gray-900">Suche</label>
				<input id="search" type="search" [value]="query" (input)="setQuery(($any($event.target)).value)"
					placeholder="Titel oder Beschreibung…" class="mt-1 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600" autocomplete="off" />
			</div>

			<!-- Genre -->
			<div class="md:col-span-3">
				<label for="genre" class="text-sm font-medium text-gray-900">Genre</label>
				<select id="genre" [value]="selectedGenre" (change)="setGenre(($any($event.target)).value)" class="mt-1 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600">
					@for (g of genres; track g) {
					<option [value]="g">{{ g }}</option>
					}
				</select>
			</div>

			<!-- Sort -->
			<div class="md:col-span-3">
				<label for="sort" class="text-sm font-medium text-gray-900">Sortierung</label>
				<select id="sort" [value]="sort" (change)="setSort(($any($event.target)).value)" class="mt-1 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600">
					<option value="relevance">Empfohlen</option>
					<option value="new_first">Neu zuerst</option>
					<option value="rating_desc">Bewertung (hoch → niedrig)</option>
					<option value="title_asc">Titel (A → Z)</option>
				</select>
			</div>

			<!-- Cloud toggle -->
			<div class="md:col-span-1 flex items-end">
				<label class="flex items-center gap-2 rounded-lg px-2 py-2">
					<input type="checkbox" [checked]="onlyCloud" (change)="toggleCloud(($any($event.target)).checked)"
						class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus-visible:ring-indigo-600" />
					<span class="text-sm text-gray-900">Cloud</span>
				</label>
			</div>
		</div>

		<div class="mt-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
			<p class="text-sm text-gray-700" aria-live="polite">
				<span class="font-semibold text-gray-900">{{ totalResults }}</span> Treffer
				@if (totalResults > 0) { <span class="text-gray-500">• Seite {{ page }} von {{ totalPages }}</span> }
			</p>

			<button type="button" (click)="clearFilters()"
				class="inline-flex w-fit items-center justify-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-900
               hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
				Filter zurücksetzen
			</button>
		</div>
	</section>

	<!-- Results -->
	<section class="mt-8">
		@if (pagedResults.length === 0) {
		<div class="rounded-2xl border border-gray-200 bg-white p-8 text-center shadow-sm">
			<h2 class="text-lg font-semibold text-gray-900">Keine Ergebnisse</h2>
			<p class="mt-2 text-sm text-gray-600">
				Passe Suche oder Filter an, um Spiele zu finden.
			</p>
			<button type="button" (click)="clearFilters()"
				class="mt-5 inline-flex items-center justify-center rounded-lg bg-indigo-600 px-5 py-3 text-sm font-semibold text-white
                 hover:bg-indigo-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
				Filter zurücksetzen
			</button>
		</div>
		} @else {
		<div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
			@for (game of pagedResults; track game.id) {
			<article class="rounded-2xl border border-gray-200 bg-white p-5 shadow-sm">
				<div class="flex items-start justify-between gap-3">
					<div>
						<h2 class="text-base font-semibold text-gray-900">{{ game.title }}</h2>
						<p class="mt-1 text-xs font-medium text-gray-600">{{ game.genre }}</p>
					</div>

					<div class="flex flex-col items-end gap-1">
						@if (game.isNew) {
						<span
							class="rounded-full bg-indigo-50 px-2 py-0.5 text-xs font-semibold text-indigo-700">Neu</span>
						}
						@if (game.cloud) {
						<span
							class="rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700">Cloud</span>
						}
					</div>
				</div>

				<p class="mt-3 text-sm text-gray-600">
					{{ game.description }}
				</p>

				<div class="mt-4 flex items-center justify-between">
					<div class="flex items-center gap-1" aria-label="Bewertung">
						@for (s of stars(game.rating); track $index) {
						<span aria-hidden="true" class="text-sm">{{ s ? '★' : '☆' }}</span>
						}
						<span class="ml-2 text-xs text-gray-600">{{ game.rating.toFixed(1) }}</span>
					</div>

					<!-- <a routerLink="/subscribe"
						class="inline-flex items-center justify-center rounded-lg bg-indigo-600 px-3 py-2 text-sm font-semibold text-white
                       hover:bg-indigo-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
						Im Abo enthalten
					</a> -->
					<a [routerLink]="['/catalog', game.id]"
						class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-900
         hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
						Details
					</a>

				</div>
			</article>
			}
		</div>

		<!-- Pagination -->
		<nav class="mt-8 flex items-center justify-between" aria-label="Seitennavigation">
			<button type="button" (click)="prevPage()" [disabled]="page === 1"
				class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-900
                 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
				Zurück
			</button>

			<div class="text-sm text-gray-700">
				Seite <span class="font-semibold text-gray-900">{{ page }}</span> von
				<span class="font-semibold text-gray-900">{{ totalPages }}</span>
			</div>

			<button type="button" (click)="nextPage()" [disabled]="page === totalPages"
				class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-900
                 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-600 focus-visible:ring-offset-2">
				Weiter
			</button>
		</nav>
		}
	</section>
</section>